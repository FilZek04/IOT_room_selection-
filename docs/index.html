<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IoT Room Selection - Project Tracker</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background: #0f172a; color: #e2e8f0; min-height: 100vh; }
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #1e293b; }
        ::-webkit-scrollbar-thumb { background: #475569; border-radius: 4px; }
        .loading { display: flex; align-items: center; justify-content: center; height: 100vh; font-size: 18px; }
        code { background: #334155; padding: 2px 6px; border-radius: 4px; font-size: 12px; }
    </style>
</head>
<body>
    <div id="root"><div class="loading">Loading project data...</div></div>
    <script type="text/babel">
        const { useState, useEffect } = React;

        const techStack = [
            { category: "Protocols", tech: "I2C/Analog + MQTT + HTTP REST", icon: "üîå" },
            { category: "Database", tech: "MongoDB", icon: "üóÑÔ∏è" },
            { category: "Backend", tech: "Python + FastAPI", icon: "‚ö°" },
            { category: "Frontend", tech: "React", icon: "‚öõÔ∏è" },
            { category: "Monitoring", tech: "Grafana", icon: "üìä" },
            { category: "Auth", tech: "JWT (bonus)", icon: "üîê" },
        ];

        const days = [
            { day: 1, label: "Mon", week: 1 }, { day: 2, label: "Tue", week: 1 },
            { day: 3, label: "Wed", week: 1 }, { day: 4, label: "Thu", week: 1 },
            { day: 5, label: "Fri", week: 1 }, { day: 6, label: "Mon", week: 2 },
            { day: 7, label: "Tue", week: 2 }, { day: 8, label: "Wed", week: 2 },
            { day: 9, label: "Thu", week: 2 }, { day: 10, label: "Fri", week: 2 },
            { day: 11, label: "Mon", week: 3 }, { day: 12, label: "Tue", week: 3 },
            { day: 13, label: "Wed", week: 3 }, { day: 14, label: "Thu", week: 3 },
            { day: 15, label: "Fri", week: 3 }, { day: 16, label: "Mon", week: 4 },
            { day: 17, label: "Tue", week: 4 }, { day: 18, label: "Wed", week: 4 },
            { day: 19, label: "Thu", week: 4 }, { day: 20, label: "Fri", week: 4 },
            { day: 21, label: "Mon", week: 5 }, { day: 22, label: "Tue", week: 5 },
            { day: 23, label: "Wed", week: 5 }, { day: 24, label: "Thu", week: 5 },
            { day: 25, label: "Fri", week: 5 }, { day: 26, label: "Mon", week: 6 },
            { day: 27, label: "Tue", week: 6 }, { day: 28, label: "Wed", week: 6 },
            { day: 29, label: "Thu", week: 6 }, { day: 30, label: "Fri", week: 6 },
        ];

        const statusColors = {
            todo: { bg: "#334155", text: "#94a3b8", label: "To Do" },
            inprogress: { bg: "#1d4ed8", text: "#93c5fd", label: "In Progress" },
            done: { bg: "#15803d", text: "#86efac", label: "Done" },
            blocked: { bg: "#b91c1c", text: "#fca5a5", label: "Blocked" },
        };

        const personColors = {
            "Anthony": { primary: "#3b82f6", light: "#1e3a5f" },
            "Fede": { primary: "#22c55e", light: "#14532d" },
            "Filip": { primary: "#a855f7", light: "#4c1d95" },
            "All": { primary: "#6b7280", light: "#374151" },
        };

        const App = () => {
            const [tasks, setTasks] = useState([]);
            const [loading, setLoading] = useState(true);
            const [error, setError] = useState(null);
            const [lastUpdated, setLastUpdated] = useState(null);
            const [filter, setFilter] = useState("All");
            const [activeTab, setActiveTab] = useState("gantt");
            const [showHelp, setShowHelp] = useState(false);

            useEffect(() => {
                fetch('./tasks.json?' + Date.now())
                    .then(res => {
                        if (!res.ok) throw new Error('Failed to load tasks');
                        return res.json();
                    })
                    .then(data => {
                        setTasks(data.tasks);
                        setLastUpdated(data.lastUpdated);
                        setLoading(false);
                    })
                    .catch(err => {
                        setError(err.message);
                        setLoading(false);
                    });
            }, []);

            if (loading) return <div className="loading">Loading project data...</div>;
            if (error) return <div className="loading" style={{color: '#ef4444'}}>Error: {error}</div>;

            const filteredTasks = filter === "All" ? tasks : tasks.filter(t => t.person === filter || t.person === "All");

            const stats = {
                total: tasks.length,
                done: tasks.filter(t => t.status === "done").length,
                inprogress: tasks.filter(t => t.status === "inprogress").length,
                blocked: tasks.filter(t => t.status === "blocked").length,
            };

            const dayWidth = 70;
            const rowHeight = 36;

            return (
                <div style={{ padding: "20px", maxWidth: "1500px", margin: "0 auto" }}>
                    {/* Header */}
                    <div style={{ marginBottom: "24px", display: "flex", justifyContent: "space-between", alignItems: "flex-start", flexWrap: "wrap", gap: "16px" }}>
                        <div>
                            <h1 style={{ fontSize: "28px", fontWeight: "700", color: "#f1f5f9", marginBottom: "4px" }}>
                                üè¢ IoT Room Selection Project
                            </h1>
                            <p style={{ color: "#64748b" }}>6-Week Phase ‚Ä¢ 3 Team Members ‚Ä¢ MVP Focus</p>
                            {lastUpdated && <p style={{ color: "#475569", fontSize: "12px", marginTop: "4px" }}>Last updated: {lastUpdated}</p>}
                        </div>
                        <div style={{ display: "flex", gap: "8px" }}>
                            <button onClick={() => setShowHelp(!showHelp)} style={{ padding: "8px 16px", borderRadius: "6px", border: "1px solid #475569", background: showHelp ? "#3b82f6" : "#1e293b", color: "#e2e8f0", cursor: "pointer", fontSize: "13px" }}>
                                {showHelp ? "‚úï Close" : "‚úèÔ∏è How to Edit"}
                            </button>
                            <a href="https://github.com/YOUR_USERNAME/iot-room-selection" target="_blank" style={{ padding: "8px 16px", borderRadius: "6px", border: "1px solid #475569", background: "#1e293b", color: "#e2e8f0", textDecoration: "none", fontSize: "13px" }}>
                                üìÇ GitHub
                            </a>
                        </div>
                    </div>

                    {/* Help Panel */}
                    {showHelp && (
                        <div style={{ background: "#1e293b", borderRadius: "12px", padding: "20px", marginBottom: "20px", border: "1px solid #334155" }}>
                            <h3 style={{ fontSize: "16px", marginBottom: "16px", color: "#f1f5f9" }}>‚úèÔ∏è How to Update Tasks</h3>
                            <div style={{ display: "grid", gap: "16px", gridTemplateColumns: "repeat(auto-fit, minmax(280px, 1fr))" }}>
                                <div style={{ background: "#0f172a", borderRadius: "8px", padding: "16px" }}>
                                    <div style={{ fontSize: "14px", fontWeight: "600", color: "#3b82f6", marginBottom: "8px" }}>Step 1: Edit tasks.json</div>
                                    <p style={{ fontSize: "13px", color: "#94a3b8", marginBottom: "8px" }}>Open <code>docs/tasks.json</code> in your editor or directly on GitHub.</p>
                                    <p style={{ fontSize: "13px", color: "#94a3b8" }}>Change <code>"status": "todo"</code> to <code>"inprogress"</code> or <code>"done"</code></p>
                                </div>
                                <div style={{ background: "#0f172a", borderRadius: "8px", padding: "16px" }}>
                                    <div style={{ fontSize: "14px", fontWeight: "600", color: "#22c55e", marginBottom: "8px" }}>Step 2: Commit & Push</div>
                                    <pre style={{ fontSize: "12px", color: "#94a3b8", background: "#1e293b", padding: "8px", borderRadius: "4px", overflow: "auto" }}>
{`git add docs/tasks.json
git commit -m "Update: task X done"
git push`}
                                    </pre>
                                </div>
                                <div style={{ background: "#0f172a", borderRadius: "8px", padding: "16px" }}>
                                    <div style={{ fontSize: "14px", fontWeight: "600", color: "#a855f7", marginBottom: "8px" }}>Step 3: Refresh Page</div>
                                    <p style={{ fontSize: "13px", color: "#94a3b8" }}>GitHub Pages updates within 1-2 minutes. Refresh this page to see changes.</p>
                                    <p style={{ fontSize: "13px", color: "#64748b", marginTop: "8px" }}>üí° Tip: Add <code>?v=2</code> to URL to bypass cache</p>
                                </div>
                            </div>
                            <div style={{ marginTop: "16px", padding: "12px", background: "#422006", borderRadius: "8px", border: "1px solid #f59e0b" }}>
                                <p style={{ fontSize: "13px", color: "#fcd34d" }}>‚ö†Ô∏è <strong>Avoid conflicts:</strong> Pull before editing, or use GitHub's web editor. Only one person should edit at a time.</p>
                            </div>
                        </div>
                    )}

                    {/* Tech Stack */}
                    <div style={{ background: "linear-gradient(135deg, #1e293b 0%, #0f172a 100%)", borderRadius: "12px", padding: "16px", marginBottom: "20px", border: "1px solid #334155" }}>
                        <h3 style={{ fontSize: "12px", textTransform: "uppercase", letterSpacing: "1px", color: "#64748b", marginBottom: "12px" }}>Tech Stack</h3>
                        <div style={{ display: "flex", gap: "12px", flexWrap: "wrap" }}>
                            {techStack.map((item, i) => (
                                <div key={i} style={{ background: "#334155", borderRadius: "8px", padding: "8px 14px", display: "flex", alignItems: "center", gap: "8px" }}>
                                    <span>{item.icon}</span>
                                    <div>
                                        <div style={{ fontSize: "10px", color: "#64748b", textTransform: "uppercase" }}>{item.category}</div>
                                        <div style={{ fontSize: "13px", fontWeight: "500", color: "#e2e8f0" }}>{item.tech}</div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>

                    {/* Progress Stats */}
                    <div style={{ display: "grid", gridTemplateColumns: "repeat(auto-fit, minmax(130px, 1fr))", gap: "12px", marginBottom: "20px" }}>
                        <div style={{ background: "#1e293b", borderRadius: "8px", padding: "14px", borderLeft: "3px solid #3b82f6" }}>
                            <div style={{ fontSize: "24px", fontWeight: "700", color: "#3b82f6" }}>{stats.total}</div>
                            <div style={{ fontSize: "12px", color: "#64748b" }}>Total</div>
                        </div>
                        <div style={{ background: "#1e293b", borderRadius: "8px", padding: "14px", borderLeft: "3px solid #22c55e" }}>
                            <div style={{ fontSize: "24px", fontWeight: "700", color: "#22c55e" }}>{stats.done}</div>
                            <div style={{ fontSize: "12px", color: "#64748b" }}>Done</div>
                        </div>
                        <div style={{ background: "#1e293b", borderRadius: "8px", padding: "14px", borderLeft: "3px solid #eab308" }}>
                            <div style={{ fontSize: "24px", fontWeight: "700", color: "#eab308" }}>{stats.inprogress}</div>
                            <div style={{ fontSize: "12px", color: "#64748b" }}>In Progress</div>
                        </div>
                        <div style={{ background: "#1e293b", borderRadius: "8px", padding: "14px", borderLeft: "3px solid #ef4444" }}>
                            <div style={{ fontSize: "24px", fontWeight: "700", color: "#ef4444" }}>{stats.blocked}</div>
                            <div style={{ fontSize: "12px", color: "#64748b" }}>Blocked</div>
                        </div>
                        <div style={{ background: "#1e293b", borderRadius: "8px", padding: "14px", borderLeft: "3px solid #a855f7" }}>
                            <div style={{ fontSize: "24px", fontWeight: "700", color: "#a855f7" }}>{Math.round((stats.done / stats.total) * 100)}%</div>
                            <div style={{ fontSize: "12px", color: "#64748b" }}>Progress</div>
                        </div>
                    </div>

                    {/* Tabs */}
                    <div style={{ display: "flex", gap: "4px", marginBottom: "16px" }}>
                        {["gantt", "list"].map(tab => (
                            <button key={tab} onClick={() => setActiveTab(tab)} style={{
                                padding: "10px 20px", borderRadius: "6px 6px 0 0", border: "none",
                                background: activeTab === tab ? "#1e293b" : "transparent",
                                color: activeTab === tab ? "#f1f5f9" : "#64748b",
                                cursor: "pointer", fontSize: "14px", fontWeight: "500"
                            }}>{tab === "gantt" ? "üìä Gantt Chart" : "üìã List View"}</button>
                        ))}
                    </div>

                    {/* Filter */}
                    <div style={{ display: "flex", gap: "8px", marginBottom: "16px", flexWrap: "wrap" }}>
                        {["All", "Anthony", "Fede", "Filip"].map(person => (
                            <button key={person} onClick={() => setFilter(person)} style={{
                                padding: "8px 16px", borderRadius: "6px", border: "none", cursor: "pointer", fontSize: "13px",
                                background: filter === person ? (personColors[person]?.primary || "#3b82f6") : "#334155",
                                color: filter === person ? "white" : "#94a3b8",
                            }}>{person}</button>
                        ))}
                    </div>

                    {/* Gantt Chart */}
                    {activeTab === "gantt" && (
                        <div style={{ background: "#1e293b", borderRadius: "12px", overflow: "hidden", border: "1px solid #334155", resize: "both", minHeight: "300px", maxHeight: "800px" }}>
                            <div style={{ maxHeight: "100%", overflow: "auto" }}>
                                <div style={{ display: "flex", borderBottom: "2px solid #334155", position: "sticky", top: 0, zIndex: 10, background: "#1e293b" }}>
                                    <div style={{ width: "280px", minWidth: "280px", padding: "12px", fontWeight: "600", color: "#94a3b8", fontSize: "13px", borderRight: "1px solid #334155" }}>Task</div>
                                    <div style={{ display: "flex" }}>
                                        <div style={{ display: "flex", flexDirection: "column", width: dayWidth * 30 }}>
                                            <div style={{ display: "flex" }}>
                                                <div style={{ width: dayWidth * 5, textAlign: "center", padding: "8px", background: "#14532d", fontWeight: "600", color: "#86efac", fontSize: "12px", borderRight: "2px solid #22c55e" }}>Week 1</div>
                                                <div style={{ width: dayWidth * 5, textAlign: "center", padding: "8px", background: "#78350f", fontWeight: "600", color: "#fcd34d", fontSize: "12px", borderRight: "2px solid #eab308" }}>Week 2</div>
                                                <div style={{ width: dayWidth * 5, textAlign: "center", padding: "8px", background: "#4c1d95", fontWeight: "600", color: "#a855f7", fontSize: "12px", borderRight: "2px solid #a855f7" }}>Week 3</div>
                                                <div style={{ width: dayWidth * 5, textAlign: "center", padding: "8px", background: "#1e3a5f", fontWeight: "600", color: "#3b82f6", fontSize: "12px", borderRight: "2px solid #3b82f6" }}>Week 4</div>
                                                <div style={{ width: dayWidth * 5, textAlign: "center", padding: "8px", background: "#14532d", fontWeight: "600", color: "#22c55e", fontSize: "12px", borderRight: "2px solid #22c55e" }}>Week 5</div>
                                                <div style={{ width: dayWidth * 5, textAlign: "center", padding: "8px", background: "#7c2d12", fontWeight: "600", color: "#f97316", fontSize: "12px" }}>Week 6</div>
                                            </div>
                                            <div style={{ display: "flex" }}>
                                                {days.map((d, i) => (
                                                    <div key={i} style={{ width: dayWidth, textAlign: "center", padding: "6px", background: d.week === 1 ? "#052e16" : d.week === 2 ? "#451a03" : d.week === 3 ? "#2e1065" : d.week === 4 ? "#0f172a" : d.week === 5 ? "#064e3b" : "#431407", borderRight: (i === 4 || i === 9 || i === 14 || i === 19 || i === 24) ? "2px solid " + (i === 4 ? "#22c55e" : i === 9 ? "#eab308" : i === 14 ? "#a855f7" : i === 19 ? "#3b82f6" : "#22c55e") : "1px solid #334155", fontSize: "11px" }}>
                                                        <div style={{ fontWeight: "500", color: "#e2e8f0" }}>{d.label}</div>
                                                        <div style={{ color: "#64748b" }}>D{d.day}</div>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                {[...filteredTasks].sort((a, b) => a.start - b.start).map((task, idx) => (
                                    <div key={task.id} style={{ display: "flex", borderBottom: "1px solid #1e293b", background: idx % 2 === 0 ? "#0f172a" : "#1e293b" }}>
                                        <div style={{ width: "280px", minWidth: "280px", padding: "8px 12px", borderRight: "1px solid #334155", display: "flex", alignItems: "center", gap: "8px" }}>
                                            <div style={{ width: "10px", height: "10px", borderRadius: "50%", background: personColors[task.person]?.primary || "#6b7280", flexShrink: 0 }} />
                                            <div style={{ flex: 1, minWidth: 0 }}>
                                                <div style={{ fontSize: "12px", color: "#e2e8f0", whiteSpace: "nowrap", overflow: "hidden", textOverflow: "ellipsis" }}>{task.name}</div>
                                                <div style={{ fontSize: "10px", color: "#64748b" }}>{task.epic}</div>
                                            </div>
                                            <span style={{ padding: "3px 8px", borderRadius: "4px", fontSize: "10px", background: statusColors[task.status]?.bg || "#334155", color: statusColors[task.status]?.text || "#94a3b8" }}>
                                                {statusColors[task.status]?.label || task.status}
                                            </span>
                                        </div>
                                        <div style={{ position: "relative", height: rowHeight, width: dayWidth * 30, display: "flex", alignItems: "center" }}>
                                            {days.map((d, i) => (
                                                <div key={i} style={{ position: "absolute", left: i * dayWidth, width: dayWidth, height: "100%", background: d.week === 1 ? "#052e16" : d.week === 2 ? "#451a03" : d.week === 3 ? "#2e1065" : d.week === 4 ? "#1e3a5f" : d.week === 5 ? "#064e3b" : "#431407", borderRight: (i === 4 || i === 9 || i === 14 || i === 19 || i === 24) ? "2px solid " + (i === 4 ? "#22c55e" : i === 9 ? "#eab308" : i === 14 ? "#a855f7" : i === 19 ? "#3b82f6" : "#22c55e") : "1px solid #1e293b" }} />
                                            ))}
                                            <div style={{
                                                position: "absolute", left: (task.start - 1) * dayWidth + 3, width: Math.max(task.duration * dayWidth - 6, 20),
                                                height: "20px", borderRadius: "4px",
                                                background: task.status === "done" ? "#15803d" : task.status === "blocked" ? "#b91c1c" : task.status === "inprogress" ? "#1d4ed8" : personColors[task.person]?.primary || "#6b7280",
                                                opacity: task.status === "done" ? 0.7 : 1, display: "flex", alignItems: "center", justifyContent: "center"
                                            }}>
                                                {task.status === "done" && <span style={{ fontSize: "10px" }}>‚úì</span>}
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}

                    {/* List View */}
                    {activeTab === "list" && (
                        <div style={{ background: "#1e293b", borderRadius: "12px", overflow: "hidden", border: "1px solid #334155" }}>
                            <table style={{ width: "100%", borderCollapse: "collapse", fontSize: "13px" }}>
                                <thead>
                                    <tr style={{ background: "#0f172a" }}>
                                        <th style={{ padding: "12px", textAlign: "left", color: "#94a3b8", fontWeight: "600" }}>Task</th>
                                        <th style={{ padding: "12px", textAlign: "left", color: "#94a3b8", fontWeight: "600" }}>Owner</th>
                                        <th style={{ padding: "12px", textAlign: "left", color: "#94a3b8", fontWeight: "600" }}>Epic</th>
                                        <th style={{ padding: "12px", textAlign: "center", color: "#94a3b8", fontWeight: "600" }}>Day</th>
                                        <th style={{ padding: "12px", textAlign: "center", color: "#94a3b8", fontWeight: "600" }}>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {[...filteredTasks].sort((a, b) => a.start - b.start).map((task, idx) => (
                                        <tr key={task.id} style={{ background: idx % 2 === 0 ? "#0f172a" : "#1e293b", borderBottom: "1px solid #334155" }}>
                                            <td style={{ padding: "10px 12px", color: "#e2e8f0" }}>{task.name}</td>
                                            <td style={{ padding: "10px 12px" }}>
                                                <span style={{ background: personColors[task.person]?.light || "#374151", color: personColors[task.person]?.primary || "#6b7280", padding: "4px 8px", borderRadius: "4px", fontSize: "11px", fontWeight: "500" }}>
                                                    {task.person}
                                                </span>
                                            </td>
                                            <td style={{ padding: "10px 12px", color: "#94a3b8" }}>{task.epic}</td>
                                            <td style={{ padding: "10px 12px", textAlign: "center", color: "#94a3b8" }}>D{Math.ceil(task.start)}</td>
                                            <td style={{ padding: "10px 12px", textAlign: "center" }}>
                                                <span style={{ padding: "4px 10px", borderRadius: "4px", fontSize: "11px", background: statusColors[task.status]?.bg || "#334155", color: statusColors[task.status]?.text || "#94a3b8" }}>
                                                    {statusColors[task.status]?.label || task.status}
                                                </span>
                                            </td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    )}

                    {/* Legend */}
                    <div style={{ marginTop: "20px", display: "flex", gap: "16px", flexWrap: "wrap", justifyContent: "center" }}>
                        {Object.entries(personColors).map(([person, colors]) => (
                            <div key={person} style={{ display: "flex", alignItems: "center", gap: "6px" }}>
                                <div style={{ width: "12px", height: "12px", borderRadius: "3px", background: colors.primary }} />
                                <span style={{ fontSize: "12px", color: "#94a3b8" }}>{person}</span>
                            </div>
                        ))}
                        <span style={{ color: "#475569" }}>|</span>
                        {Object.entries(statusColors).map(([status, colors]) => (
                            <div key={status} style={{ display: "flex", alignItems: "center", gap: "6px" }}>
                                <div style={{ width: "12px", height: "12px", borderRadius: "3px", background: colors.bg }} />
                                <span style={{ fontSize: "12px", color: "#94a3b8" }}>{colors.label}</span>
                            </div>
                        ))}
                    </div>

                    {/* Footer */}
                    <div style={{ marginTop: "24px", textAlign: "center", color: "#475569", fontSize: "12px" }}>
                        IoT Room Selection ‚Ä¢ BPINFOR-124 ‚Ä¢ University of Luxembourg 2024-2025
                    </div>
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
